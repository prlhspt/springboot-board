<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <link th:href="@{/css/bootstrap.min.css}" href="/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

<table id="datatable-scroller"
       class="table table-bordered tbl_Form m-5" style="width: 60%">
    <tbody>
    <tr>
        <th class="active">작성자</th>
        <td th:text="*{detailPost.writer}"/></td>
    </tr>
    <tr>
        <th class="active">제목</th>
        <td th:text="*{detailPost.title}"/></td>
    </tr>
    <tr>
        <th class="active">작성일</th>
        <td th:text="${#temporals.format(detailPost.createdDate, 'yyyy-MM-dd HH:mm:ss')}"></td>
    </tr>
    <tr>
        <th class="active">조회수</th>
        <td th:text="*{detailPost.view}"></td>
    </tr>
    </tbody>
</table>

<div class="container m-5">
    <p th:text="*{detailPost.content}"></p>
</div>

<div class="container m-5">
    <h3 class="py-4">댓글</h3>

    <div class="table-wrap">
        <table class="table">
            <thead class="thead-dark">
            <tr>
                <th>내용</th>
                <th>작성자</th>
                <th>작성일</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="comment : ${detailPost.comment}" class="alert" role="alert">
                <td th:text="${comment.content}"></td>
                <td th:text="${comment.writer}"></td>
                <td th:text="${#temporals.format(comment.createdDate, 'yyyy-MM-dd HH:mm:ss')}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <h5 sec:authorize="isAnonymous()" class="pt-4">댓글은 로그인 후 작성하실 수 있습니다.</h5>
    <button sec:authorize="isAnonymous()" class="w-100 btn btn-secondary btn-lg" onclick="location.href='auth/login.html'"
            th:onclick="|location.href='@{/auth/login}'|" type="button">로그인</button>

    <form sec:authorize="isAuthenticated()" th:action="@{/post/comment/{id}/new (id=${detailPost.id})}" th:object="${commentSaveRequestDto}" method="post">
        <div class="form-group mb-3 mt-3">
            <textarea class="form-control" th:field="*{content}" rows="10" th:errorclass="field-error"></textarea>
            <div class="field-error" th:errors="*{content}" />
        </div>

        <hr class="my-4">

        <button class="w-100 btn btn-primary btn-lg" type="submit">댓글 등록</button>

    </form>


</div>


</body>
</html>
